generator client {
  provider = "prisma-client-js"
  output   = "../node_modules/.prisma/client"
}

datasource db {
  provider = "postgresql"
}

enum Role {
  admin
  jobseeker
}

enum JobStatus {
  open
  closed
}

enum ApplicationStatus {
  submitted
  reviewed
  rejected
}

model User {
  id           String        @id @default(uuid())
  fullName     String
  email        String        @unique
  password     String
  role         Role          @default(jobseeker)
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
  createdJobs  Job[]         @relation("CreatedJobs")
  applications Application[]
}

model Job {
  id           String        @id @default(uuid())
  title        String
  description  String
  location     String
  salary       Float?
  status       JobStatus     @default(open)
  createdAt    DateTime      @default(now())
  updatedAt    DateTime      @updatedAt
  createdBy    String
  creator      User          @relation("CreatedJobs", fields: [createdBy], references: [id], onDelete: Cascade)
  applications Application[]

  @@index([status])
  @@index([location])
}

model Application {
  id          String            @id @default(uuid())
  resume      String
  coverLetter String
  status      ApplicationStatus @default(submitted)
  createdAt   DateTime          @default(now())
  updatedAt   DateTime          @updatedAt
  jobId       String
  job         Job               @relation(fields: [jobId], references: [id], onDelete: Cascade)
  userId      String
  user        User              @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([jobId, userId])
  @@index([jobId])
  @@index([userId])
}
